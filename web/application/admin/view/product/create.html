{include file="layout/header" title="" keywords="" /}

{include file="layout/left" groupId="$groupId" keywords="" /}
<style type="text/css">
    #custom-container > tr> td > input{
        width: 130px !important;
    }
</style>
<div class="content-wrapper">
    <div class="content-header">
        <div class="container-fluid">
            <div class="row mb-2">
                <div class="col-sm-6">
                    <h1 class="m-0 text-dark"></h1>
                </div><!-- /.col -->
                <div class="col-sm-6">
                    <ol class="breadcrumb float-sm-right">
                        <li class="breadcrumb-item"><a href="#">Home</a></li>
                        <li class="breadcrumb-item"><a href="#">商品管理</a></li>
                        <li class="breadcrumb-item active">商品添加</li>
                    </ol>
                </div>
            </div>
        </div>
    </div>
    <section class="content">
        <div class="container-fluid">
            <div class="row">
                <div class="col-md-12">
                    <div class="card card-primary">
                        <form id="add-form" role="form" action="{:url('')}" method="post"  ><!-- onsubmit="return validateSubmit()" -->
                            <div class="card-body">
                                <div class="form-inline form-group">
                                    <label  class="col-md-2">*选择供应商</label>
                                    <div class="col-md-5 no-padding">
                                        <div class="row">
                                          <select class="form-control col-md-6 select2" name="supplier_id">
                                                {volist name=":getSupplierList()"  id='user'}
                                                <option  value="{$user.id}">{$user.real_name}</option>
                                                {/volist}
                                          </select>
                                        </div>
                                    </div>
                                </div>
                                <div class="form-inline form-group ajax-bind-change">
                                    <label for="" class="col-md-2">*所属类目</label>
                                    <div class="col-md-9 no-padding">
                                        <div id="category-template-box"></div>
                                        
                                    </div>
                                </div>
                             
                                <div class="form-inline form-group">
                                    <label class="col-md-2">*商品名称</label>
                                    <div class="col-md-5 no-padding">
                                        <div class="row">
                                            <input type="text"  name="title" maxlength="30" class="form-control col-md-6" />
                                        </div>
                                    </div>
                                </div>
                                
                                <br/><br/>
                                <div class="form-inline form-group">
                                    <div class="col-md-12 no-padding">
                                        <button type="button" class="btn btn-primary" id="combination-container-add">添加规格组合</button>

                                        <input type="checkbox" class="js_specification_customization" /> 定制
                                        <div class="card" style="display: none">
                                            <div class="card-body p-0">
                                                <table class="table table-striped">
                                                    <thead >
                                                    <tr>
                                                        <th>组合规格</th>
                                                        <th>计量单位</th>
                                                        <th>是否电议</th>
                                                        <th>单价</th>
                                                        <th>起售数量</th>
                                                        <th>操作</th>
                                                    </tr>
                                                    </thead>
                                                    <tbody id="custom-container">
                                                        <tr>
                                                            <td>定制</td>
                                                            <td>
                                                                <select class="form-control"  name="unit">
                                                                    <option value="-1" >请选择</option>
                                                                    {foreach name="unitRows" id="unit"}
                                                                    <option value="{$unit.id}" >{$unit.name}</option>
                                                                    {/foreach}
                                                                    <option value="0" >自定义</option>
                                                                </select>
                                                                <input type="text"  class="form-control col-md-3" value=""  style="display: none" />
                                                            </td>
                                                            <td>
                                                                <input type="checkbox" class="" />
                                                            </td>
                                                            <td>
                                                                <input type="text" class="form-control col-md-3" value=""  name="standard[{{index}}][e_price]" />
                                                            </td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="form-inline form-group">
                                    <div class="col-md-12 no-padding">
                                        <div class="card">
                                            <div class="card-body p-0">
                                                <table class="table table-striped">
                                                    <thead >
                                                    <tr>
                                                        <th>组合规格</th>
                                                        <th>计量单位</th>
                                                        <th>是否电议</th>
                                                        <th>单价</th>
                                                        <th>起售数量</th>
                                                        <th>图片</th>
                                                        <th>操作</th>
                                                    </tr>
                                                    </thead>
                                                    <tbody id="combination-container" data-category="">
                                                     
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <br/><br/>

                                
                                <div id="standard_container" class="js_ajax_bind_change"></div>
    

                                <div class="form-inline form-group">
                                    <label class="col-md-2">*产品主图</label>
                                    <div class="col-md-5 no-padding">
                                        <div class="row">
                                            <div class="col-md-6 no-padding">
                                                <input id="cover-file" name="file" type="file"   data-show-caption="true">
                                            </div>
                                            <p class="help-block2" style="padding-top: 6px;padding-left: 5px;">支持jpg、jpeg、png格式，大小不超过2.0M</p>
                                        </div>
                                        <div class="row">
                                            <input  type="hidden" name="cover_path" id="cover-upload-file"  value="" />
                                            <small class="help-block" style="padding-top: 6px;padding-left: 5px;"></small>
                                        </div>
                                    </div>
                                </div>
                                <div class="form-inline form-group">
                                    <label  class="col-md-2">多视角图片</label>
                                    <div class="col-md-5 no-padding">
                                        <div class="row">
                                            <div class="col-md-6 no-padding">
                                                <input id="multi-file" name="file" type="file" data-show-caption="true"  multiple>
                                            </div>
                                            <p class="help-block2" style="padding-top: 6px;padding-left: 5px;">支持jpg、jpeg、png格式，大小不超过2.0M</p>

                                        </div>
                                        <div class="row">
                                            <input  type="hidden" name="multi_angle_img" id="multi-upload-file"  value="" />
                                            <small class="help-block" style="padding-top: 6px;padding-left: 5px;"></small>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="form-inline form-group">
                                    <label for="" class="col-md-2">产地</label>
                                    <div class="col-md-5 no-padding">
                                        <div class="row">
                                            <select  id="goods_type" class="form-control col-md-2"  name="province_of_origin_id|city_of_origin_id|district_of_origin_id">
                                                <option  value="0">请选择</option>
                                                {foreach name=":getTypeLevelList(3)" id="type"}
                                                <option value="{$type.id}" >
                                                    {if $type.level == 2}&nbsp;&nbsp;&nbsp;&nbsp;|-&nbsp;{elseif $type.level == 3}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|-&nbsp;{/if}{$type.name}</option>
                                                {/foreach}
                                            </select>
                                        </div>
                                    </div>
                                </div>
                                <div class="form-inline form-group">
                                    <label class="col-md-2">商品详情APP/H5</label>
                                    <div class="col-md-7 no-padding">
                                        <div class="row">
                                            <textarea id="goods-content" class="textarea goods-content" placeholder="商品详情..."  name="content"  style="width: 100%; height: 200px; font-size: 14px; line-height: 18px; border: 1px solid #dddddd; padding: 10px;"></textarea>
                                        </div>
                                    </div>
                                </div>
                                <div class="form-inline form-group">
                                    <label class="col-md-2">商品详情Web</label>
                                    <div class="col-md-7 no-padding">
                                        <div class="row">
                                            <textarea id="web-goods-content" class="textarea goods-content" placeholder="商品详情..."  name="web_content"  style="width: 100%; height: 200px; font-size: 14px; line-height: 18px; border: 1px solid #dddddd; padding: 10px;"></textarea>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="card-footer col-md-offset-2">
                                <button type="submit" class="btn btn-primary">添加</button>
                                <small class="submit-tip" style="padding-top: 6px;padding-left: 5px;color: #a94442"></small>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </section>
</div>

{include file="layout/footer" title="$title" keywords="" /}
<link href="__STATIC__/js/plugins/bootstrap-fileinput/css/fileinput.css" media="all" rel="stylesheet" type="text/css" />
<link rel="stylesheet" href="__STATIC__/js/plugins/kindeditor/themes/default/default.css" />
<link rel="stylesheet" href="__STATIC__/js/plugins/kindeditor/plugins/code/prettify.css" />
<link rel="stylesheet" href="__STATIC__/js/plugins/bootstrapvalidator/css/bootstrapValidator.css"/>
<script src="__STATIC__/js/plugins/bootstrap-fileinput/js/fileinput.js" type="text/javascript"></script>
<script type="text/javascript" src="__STATIC__/js/plugins/bootstrapvalidator/js/bootstrapValidator.js"></script>
<script type="text/javascript" src="__STATIC__/js/template-web.js"></script>
<script src="__STATIC__/js/plugins/kindeditor/kindeditor-all.js"></script>
<script src="__STATIC__/js/plugins/kindeditor/lang/zh-CN.js"></script>
<link rel="stylesheet" href="__STATIC__/js/plugins/select2/select2.css" />
<script src="__STATIC__/js/plugins/select2/select2.min.js" type="text/javascript"></script>

<!-- 1选择供应商 start -->
    <script>
        $(function () {
            $('.select2').select2();
        })
    </script>
    <style>
    .select2-container .select2-selection--single{height: 38px;}
    .select2-container--default .select2-selection--single{border-color: #ced4da;}
    .select2-container--default .select2-selection--single .select2-selection__rendered{line-height: 38px;}
    .select2-container--default .select2-selection--single .select2-selection__arrow{top: 4px;}
    </style>
<!-- 1选择供应商 end -->



<!-- 2所属类目 start -->
    <script id="next-template" type="text/html">
        {{ if lineType == 'next' }}
            <span class="select-level-div">
                <select class="form-control select-level next">
                    <option  value="0">请选择</option>
                    {{each categoryNextLevelList as value}}
                        <option value="{{value.id}}" >{{value.name}}</option>
                    {{/each}}
                </select>
            </span>
        {{/if}}
        
        {{ if lineType == 'ready' }}
            <div class="row category-box" id="">
                <div class="select-level-div">
                    <select class="form-control select-level">
                        <option  value="0">请选择</option>
                        {{each categoryNextLevelList as value}}
                            <option value="{{value.id}}" >{{value.name}}</option>
                        {{/each}}
                    </select>
                </div>
                <a href="javascript:;" class="category-add" style="padding-top: 6px;padding-left: 5px;">&nbsp;&nbsp;&nbsp;&nbsp;继续添加</a>
                <input type="hidden" name='category_id[]' class="category-value-input" value="{$category_id??''}">
            </div>
        {{/if}}

        {{ if lineType == 'add' }}
            <div class="row category-box" style="margin-top: 10px;">
                <div class="select-level-div">
                    <select class="form-control select-level">
                        <option  value="0">请选择</option>
                        {{each categoryNextLevelList as value}}
                            <option value="{{value.id}}" >{{value.name}}</option>
                        {{/each}}
                    </select>
                </div>
                <a href="javascript:;" class="category-del" style="padding-top: 6px;padding-left: 5px;">&nbsp;&nbsp;&nbsp;&nbsp;删除当前</a>
                <input type="hidden" name='category_id[]' class="category-value-input">
            </div>
        {{/if}}
    </script>
    <script>
            function ajaxGetCategory(id,elm,htmlType,lineType){
                $.ajax({
                    type:'get',
                    url:'?s=admin/product/getCategoryNextLevelList&parentId='+id,
                    data:{},
                    dataType:'json',
                    success:function (data) {
                        if(data.status == 0){
                            if(data.data.list.length>0){
                                if(typeof(elm) == 'string'){
                                    elm = $(elm);
                                }
                                var html = template('next-template',{categoryNextLevelList:data.data.list,lineType:lineType});
                                if(htmlType == 'html'){
                                    elm.html(html);
                                }else if(htmlType == 'after'){
                                    elm.after(html);
                                }
                            }
                            
                        }
                    }
                });
            }

            //加载首个分类
            ajaxGetCategory(0,'#category-template-box','html','ready');

            //增加分类
            $('.ajax-bind-change').on('click',".category-add",function(){
                if($('.ajax-bind-change .category-box').length>=5){
                    alert('最多只能关联五个');
                    return false;
                }
                ajaxGetCategory(0,'.ajax-bind-change .category-box:last','after','add');
            });

            //删除分类
            $('.ajax-bind-change').on('click',".category-del",function(){
                $(this).parent('.category-box').remove();
            });

            //给分类下的下拉框绑定事件
            $('.ajax-bind-change').on('change','.select-level',function () {
                var typeId = $(this).val();//获取当前选中的分类值
                $(this).siblings('.select-level-div').remove();//把当前触发的下拉框下级的去掉
                if(typeId>0){
                    ajaxGetCategory(typeId,$(this),'after','next');
                }else{
                    //获取上一级的选中分类值
                    var preSelectValue = $(this).parent('.select-level-div').siblings('.select-level').val();
                    if(preSelectValue!= undefined ){
                        typeId = preSelectValue;
                    }
                }

                //选中的值赋值于input[type=hidden]
                $(this).parents('.category-box').children('.category-value-input').val(typeId);
            });
    </script>
<!-- 2所属类目 end -->


<!-- 3规格组合 start -->
    <script id="container-template" type="text/html">
        {{ if categoryAttr !='' }}
        <tr>
            <td>
                {{each categoryAttr as colv}}
                    {{ if colv['spec_attr_key']=='颜色' }}
                        <select class="form-control js_specification_attr js_specification_color"  name="category{{colv['id']}}">
                            <option value="-1" data-spec_attr_key="{{colv['id']}}">{{colv['spec_attr_key']}}</option>
                            {{each colv['spec_attr_val'] as colvv}}
                                <option data-spec_attr_option="{{colvv['id']}}" value="{{colvv['id']}}">{{colvv['spec_option_text']}} </option>
                            {{/each}}
                            <option data-spec_attr_option="0"  value="0">自定义颜色</option>
                            <input type="text" class="form-control col-md-2 colorText"   style="display: none"/>
                        </select>
                    {{ else }}
                        <select class="form-control js_specification_attr"  name="category{{colv['id']}}">
                            <option value="-1" data-spec_attr_key="{{colv['id']}}">{{colv['spec_attr_key']}}</option>
                            {{each colv['spec_attr_val'] as colvv}}
                                <option data-spec_attr_option="{{colvv['id']}}">{{colvv['spec_option_text']}} </option>
                            {{/each}}
                        </select>
                    {{/if}}
                {{/each}}
            </td>
            <td>
                <select class="form-control unit"  name="unit[]">
                    <option value="-1" >请选择</option>
                    {foreach name="unitRows" id="unit"}
                    <option value="{$unit.id}" >{$unit.name}</option>
                    {/foreach}
                    <option value="0" >自定义单位</option>
                </select>
                <input type="text" class="form-control col-md-2 unitText" name="unit_text[]" style="display: none"/>
            </td>
            <td>
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" value="1" name="is_price_neg_at_phone[]">
                    <label class="form-check-label">是</label>
                </div>
            </td>
            <td><input type="number" class="form-control" value="0.00"  name="price[]" /></td>
            <td><input type="number" class="form-control" value="1"  name="min_order_qty[]" /></td>
            <td>
                <input class="js_specification_picture" name="file" type="file" style="display: inline;">
                <input  type="hidden" class="js_specification_picture_data"  value="" />
            </td>
            <td>    
                <button type="button" class="btn btn-success  js_specification_price">设置价格区间</button>
                <input type="hidden" class="js_specification_price_data" name="price_section[]">
                <button type="button" class="btn btn-danger  js_specification_delete">删除</button>
            </td>
        </tr>
        {{/if}}
    </script>
    <script>
        //有颜色规格 事件监听选择自定义
        $('#combination-container').on('change','.js_specification_color',function(){
            if($(this).val()==0){
                $(this).siblings('.colorText').show();
                $(this).siblings('.colorText').val('');
            }else{
                $(this).siblings('.colorText').hide();
                $(this).siblings('.colorText').val('');
            }
        });
        //单位 事件监听选择自定义
        $('#combination-container').on('change','.unit',function(){
            if($(this).val()==0){
                $(this).siblings('.unitText').show();
                $(this).siblings('.unitText').val('');
            }else{
                $(this).siblings('.unitText').hide();
                $(this).siblings('.unitText').val('');
            }
            
        })

        //初始化数据显示
        combinationContainerEmpty(false);

        //验证是否处于无数据状态
        function combinationContainerEmpty($clear=true){
            if($clear){
                $("#combination-container").html('');
            }else{
                if($("#combination-container tr").length == 0){
                    $("#combination-container").html('<tr><td colspan="7" class="text-center">暂无任何的规格组合</td></tr>');
                }
            }
        }

        //赋值显示
        function combinationContainerColspan(categoryAttr){
            // combinationContainerEmpty();
            var html = template('container-template',{'categoryAttr':categoryAttr});
            $('#combination-container').append(html);
        }

        //添加规格按钮事件监听
        $("#combination-container-add").click(function(){
            //获取主分类选中的ID
            var categoryId = $('#category-template-box .category-box:first .category-value-input').val();
            if(categoryId==0){
                alert('请先选择分类');
                return;
            }
            //获取规格数据并缓存起来
            var categoryAttr = $('#combination-container').data('category'+categoryId);
            console.log(categoryAttr);
            if(categoryAttr == undefined){
                $.ajax({
                        type:'get',
                        url:'?s=admin/product/getCategoryAttr&categoryId='+categoryId,
                        data:{},
                        dataType:'json',
                        success:function (data) {
                            if(data.status == 0){
                                $('#combination-container').data('category'+categoryId,data.data.list);
                                combinationContainerColspan(data.data.list);
                                eachPicture();
                            }
                        }
                    });
            }else{
                combinationContainerColspan(categoryAttr);
                eachPicture();
            }
        });
    </script>
<!-- 图片上传 -->
<script>
    function eachPicture(){
        $('#combination-container .js_specification_picture').each(function(i,n){
            $(n).fileinput({
                language: 'zh', //设置语言
                uploadUrl: '?s=admin/file/upload',  //上传地址
                showUpload: true, //是否显示上传按钮
                showRemove:true,
                dropZoneEnabled: false,
                showCaption: false,//是否显示标题
                allowedPreviewTypes: ['image'],
                allowedFileTypes: ['image'],
                allowedFileExtensions:  ['jpg', 'png','jpeg'],
                maxFileSize : 5120,
                maxFileCount: 1,
                uploadExtraData: function(previewId, index) {   //额外参数的关键点
                    var obj = {};
                    obj.type = 'goods_thumb';
                    return obj;
                }
            });
            $(n).on("fileuploaded", function(event, data) {
                if(data.response){
                    $(this).parents('.file-input').siblings('.js_specification_picture_data').val(data.response.data.filename);
                }
            });
            $(n).on('fileclear', function(event,id) {
                $(this).parents('.file-input').siblings('.js_specification_picture_data').val('');
            });
        });
    }
</script>
<!-- 价格 -->
    <div class="modal fade" id="price-modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                
            </div>
        </div>
    </div>
    <script id="price-template" type="text/html">
        <div class="modal-body">
            <div class="card" >
                <div class="card-body p-0">
                    <table class="table table-striped">
                        <thead>
                        <tr>
                            <th>数量区间</th>
                            <th>产品单价</th>
                            <th>&nbsp;&nbsp;</th>
                        </tr>
                        </thead>
                        <tbody class="price-add">
                            <tr>
                                <td>
                                    <input type="number" class="min" style="width: 80px;" />&nbsp;-&nbsp;
                                    <input type="number" class="max"  style="width: 80px;" />
                                </td>
                                <td>
                                    <input type="number" class="price" style="width: 120px;" />
                                </td>
                                <td>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        <div class="modal-footer">
            <a href="javascript:;" id="price-add" style="float: left;margin-right: 220px;">+新增价格区间</a>
            <button type="button" class="btn btn-secondary" data-dismiss="modal">取消</button>
            <button type="button" class="btn btn-primary" data-id="" id="down-request">保存</button>
        </div>
    </script>
    <script>
        //价格区间弹出层
        $('#combination-container').on('click','.js_specification_price', function (event) {
            var html = template('price-template',{'xx':'xx'})
            $('#price-modal .modal-content').html(html);
            $('#price-modal').modal('show');

            var priceIndex = $(this).parents('tr').index();

            //点击保存把价格区间全部拿出来存储
            $('#down-request').click({'priceIndex':priceIndex},function(obj){
                //价格区间对象
                var priceSection =  $(this).parents('.modal-footer').siblings('.modal-body').find('.price-add');
                console.log(priceSection);
                console.log(obj.data.priceIndex);
            });
        });
        //添加价格区间
        $('body').on('click','#price-add', function (event) {
            $(this).parent('.modal-footer').siblings('.modal-body').find('.price-add').append('<tr><td><input type="number" value="" style="width: 80px;" />&nbsp;-&nbsp;<input type="number"  value="" style="width: 80px;" /></td><td><input type="number"  value="" style="width: 120px;" /></td><td><a href="javascript:;" >删除</a></td></tr>');
        });

    </script>
<!-- 删除 -->
    <script>
        $('#combination-container').on('click','.js_specification_delete', function (event) {
            //移除当前操作行
            $(this).parents('tr').remove();
            //如果是修改的把删除的ID记录起来
            //
        });
    </script>
<!-- 3规格组合 end -->


<!-- 4产品主图 start-->
    <script>
        // 单图上传
        $("#cover-file").fileinput({
            language: 'zh', //设置语言
            uploadUrl: '?s=admin/file/upload',  //上传地址
            showUpload: true, //是否显示上传按钮
            showRemove:true,
            dropZoneEnabled: false,
            showCaption: true,//是否显示标题
            allowedPreviewTypes: ['image'],
            allowedFileTypes: ['image'],
            allowedFileExtensions:  ['jpg', 'png','jpeg'],
            maxFileSize : 5120,
            maxFileCount: 1,
            uploadExtraData: function(previewId, index) {   //额外参数的关键点
                var obj = {};
                obj.type = 'goods_thumb';
                return obj;
            }
        });        
        $('#cover-file').on("fileuploaded", function(event, data) {
            if(data.response){
                $('#cover-upload-file').val(data.response.data.filename);
            }
        });
        $('#cover-file').on('fileclear', function(event,id) {
            $('#cover-upload-file').val('');
        });
    </script>
<!-- 4产品主图 end-->

<!-- 5多视角图片 start -->
    <script>
        //多图上传
        $("#multi-file").fileinput({
            language: 'zh', //设置语言
            uploadUrl: '?s=admin/file/upload',  //上传地址
            showUpload: true, //是否显示上传按钮
            showRemove:true,
            dropZoneEnabled: false,
            showCaption: true,//是否显示标题
            allowedPreviewTypes: ['image'],
            allowedFileTypes: ['image'],
            allowedFileExtensions:  ['jpg', 'png','jpeg'],
            maxFileSize : 5120,
            maxFileCount: 20,
            uploadExtraData: function(previewId, index) {   //额外参数的关键点
                var obj = {};
                obj.type = 'goods';
                return obj;
            }
        });
        $('#multi-file').on("fileuploaded", function(event, data) {
            if(data.response) {
                var str = $('#multi-upload-file').val();
                var newStr = str ? str+'|'+data.response.data.filename : data.response.data.filename;
                $('#multi-upload-file').val(newStr);
                $('#multi-upload-file').closest('.form-group').removeClass('has-error');
                $('#multi-upload-file').closest('.form-group').find('.help-block').hide();
            }
        });
        $('#multi-file').on('fileclear', function(event) {
            $('#multi-upload-file').val('');
        });
    </script>
<!-- 5多视角图片 end -->


<!-- 6产地 start -->
<!-- 6产地 end -->


<!-- 7商品详情App/H5 start -->
<!-- 7商品详情App/H5 end -->


<!-- 8商品项目web start -->
<!-- 8商品项目web end -->



<!-- 9菜单选中 start -->
    <script>
        var url = '{:url("admin/product/create")}';
        $('a[href="'+url+'"]').addClass('active');
        $('a[href="'+url+'"]').parent().parent().parent().addClass('menu-open');
    </script>
<!-- 9菜单选中 end -->



<!-- 表单提交验证 start -->
    <script type="text/javascript">
        function validateSubmit() {
            $('#cover-upload-file').closest('.form-group').removeClass('has-error');
            $('#cover-upload-file').closest('.form-group').find('.help-block').html('');
            $('.submit-tip').html('');
           // custom-container
            var customLength =  $('#custom-container').find('tr').length;

            var valid = true;
            //图片验证
            if ($('#cover-upload-file').val() == '') {
                $('#cover-upload-file').closest('.form-group').addClass('has-error');
                $('#cover-upload-file').closest('.form-group').find('.help-block').html('请上传封面图片');
                valid = false;
            }
            if(customLength == 0){
                $('.submit-tip').html('请设置商品规格');
                valid = false;
            }

            var result = $("#add-form").data('bootstrapValidator').isValid();
            if (result && valid) {
                return true;
            }
            return false;
        }

        //定义全局变量
          var g_color = 0;
          var g_option = 0;
        KindEditor.ready(function(K) {
            var editor1 = K.create('#goods-content', {
                cssPath : '__STATIC__/js/plugins/kindeditor/plugins/code/prettify.css',
                uploadJson : '/?s=admin/file/upload2',
                allowFileManager : true,
                afterCreate : function() {
                }
            });
            var editor2 = K.create('#web-goods-content', {
                cssPath : '__STATIC__/js/plugins/kindeditor/plugins/code/prettify.css',
                uploadJson : '/?s=admin/file/upload2',
                allowFileManager : true,
                afterCreate : function() {
                }
            });
        })


    </script>
<!-- 表单提交验证 end -->
